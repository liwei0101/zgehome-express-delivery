(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58cf9493"],{"3d2e":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-page"},[a("div",{staticClass:"div3"},[a("iview-custom-breadcrumb",{attrs:{separator:">",BreadcrumbItemList:t.iviewBread}}),a("div",{staticClass:"div2"},[a("div",{staticClass:"div"},[a("span",{staticClass:"goText"},[t._v("\n\t\t\t\t\t\t"+t._s(isNaN(t.$route.query.id)?"新建":"编辑")+"\n\t\t\t\t\t")]),a("Button",{staticClass:"button",on:{click:t.goback}},[a("span",{staticClass:"goText1"},[t._v("返回")])])],1),a("Form",{ref:"params",staticClass:"form",attrs:{"label-width":90,inline:!1,model:t.params,rules:t.ruleValidate}},[a("FormItem",{attrs:{label:"公司名称",prop:"name"}},[a("Input",{attrs:{placeholder:"请输入公司名称（60字以内）",maxlength:60},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name","string"===typeof e?e.trim():e)},expression:"params.name"}})],1),a("FormItem",{attrs:{label:"公司地址",prop:"address"}},[a("Input",{attrs:{placeholder:"请输入公司地址（60字以内）",maxlength:60},model:{value:t.params.address,callback:function(e){t.$set(t.params,"address","string"===typeof e?e.trim():e)},expression:"params.address"}})],1),a("FormItem",{attrs:{label:"联系电话",prop:"telephone"}},[a("Input",{attrs:{placeholder:"请输入联系电话（15字以内）",maxlength:15},on:{"on-keyup":t.changePhone},model:{value:t.params.telephone,callback:function(e){t.$set(t.params,"telephone","string"===typeof e?e.trim():e)},expression:"params.telephone"}})],1),a("FormItem",{attrs:{label:"公司封面",prop:"frontCover"}},[a("iview-custom-select-img",{attrs:{action:"/pc/pcUploadFile",accept:"image/gif,image/jpeg,image/png",format:t.iviewImg,maxSize:2048,imgsLength:1,heightImg:70,imgSize:20,imgType:"ios-camera",defaultList:t.defaultList},on:{handleSuccess:t.getUploaddata,handleRemove:t.moveUploadimg}}),a("p",{staticStyle:{"font-size":"14px"}},[t._v("上传2M以内且格式为jpg/jpeg/png/bmp格式的图片")])],1),a("FormItem",{staticClass:"textarea",attrs:{label:"公司介绍"}},[a("iview-custom-editor",{ref:"editor",attrs:{uploadImg:!0,showLinkImg:!0,upFileBase64:!1,imgServer:!0,uploadUrl:"/pc/pcUploadFile",uploadImgMaxLength:1,pasteFilterStyle:!1,initData:t.params.compayIntroduce,menus:t.iviewCustomEditorMenus},on:{change:t.getContentdata}}),a("div",{staticStyle:{float:"right"}},[a("span",{staticClass:"counter",staticStyle:{right:"20px",bottom:"auto"}},[t._v("最多输入150字")])]),t.showDetailTextError?a("div",{staticClass:"ivu-form-item-error-tip"},[t._v("请输入公司介绍")]):t._e(),t.params.detailText&&t.params.detailText.length>150?a("div",{staticClass:"ivu-form-item-error-tip"},[t._v("最多输入150字")]):t._e()],1)],1),a("div",{staticClass:"div1"},[a("Button",{staticClass:"button1",attrs:{type:"primary"},on:{click:function(e){return t.saveInfo(2,"params")}}},[t._v("\n            保存并发布\n          ")]),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.saveInfo(1,"params")}}},[t._v("\n            保存\n          ")])],1)],1)],1)])},s=[],i=a("c276"),n={components:{},props:{},data:function(){return{ruleValidate:{name:[{required:!0,message:"请输入公司名称",trigger:"blur"}],address:[{required:!0,message:"请输入公司地址",trigger:"blur"}],telephone:[{required:!0,message:"请输入联系电话",trigger:"blur"}],frontCover:[{required:!0,message:"请添加公司封面",trigger:"change"}]},showDetailTextError:!1,iviewBread:[{to:"/express",text:"快递速寄",replace:!1,target:"_self",append:!1},{text:isNaN(this.$route.query.id)?"新建":"编辑",replace:!1,target:"_self",append:!1}],iviewImg:["jpg","jpeg","png","bmp"],iviewCustomEditorMenus:["head","bold","fontSize","italic","underline","strikeThrough","foreColor","backColor","justify"],defaultList:[],params:{id:null,title:null,frontCover:null,videoContent:null,detail:null,pageview:null,category:1,pubTime:null,pubStatus:null,deleteFlag:null,createBy:null,createTime:null,updateBy:null,updateTime:null}}},created:function(){Object(i["c"])(isNaN(this.$route.query.id)?"新建":"编辑"),this.getData()},methods:{goback:function(){var t=this;this.$Modal.confirm({title:"提示",content:"返回后已输入的内容将会丢失，确认返回？",okText:"确认",cancelText:"取消",onOk:function(){t.$router.go(-1)}})},saveInfo:function(t,e){var a=this;setTimeout((function(){a.$refs[e].validate((function(e){if(a.showDetailTextError=!a.params.detailText,e&&!a.showDetailTextError&&a.params.detailText.length<=150){if(a.params.pubStatus=t,!a.params.id){var r=Object.assign({},a.params);return delete r.detailText,a.$http.post("/pc/expressCompany/insert",r).then((function(t){return 0==t.meta.code?a.$router.go(-1):a.$Message.error(t.meta.message),Promise.resolve(t)})).catch((function(t){return Promise.reject(t)}))}a.updateById()}}))}),10)},getUploaddata:function(t){console.log("获取图片地址"),this.params.frontCover=t.res.data.fileUrl},moveUploadimg:function(){this.params.frontCover=""},getContentdata:function(t){this.$set(this.params,"compayIntroduce",t.editorContent),this.$set(this.params,"detailText",t.editorContent.replace(/<[^>]+>|[&nbsp;]/gi,""))},getData:function(){var t=this;if(this.$route.query.id){this.params.id=this.$route.query.id;var e=Object.assign({},this.params);return delete e.detailText,this.$http.post("/pc/expressCompany/selectById",e).then((function(e){return t.params=e.data,t.params.detailText=e.data.compayIntroduce.replace(/<[^>]+>/gi,"")||"",t.$nextTick((function(){t.$refs.editor&&t.$refs.editor.eidtor.txt.html(e.data.compayIntroduce)})),t.defaultList.push(t.params.frontCover),Promise.resolve(e)})).catch((function(t){return Promise.reject(t)}))}},updateById:function(){var t=this,e=Object.assign({},this.params);return delete e.detailText,this.$http.post("/pc/expressCompany/updateById",e).then((function(e){return t.$router.go(-1),Promise.resolve(e)})).catch((function(t){return Promise.reject(t)}))},changePhone:function(t){var e=t.target.value.replace(/[^0-9-]/gi,"");this.$set(this.params,"telephone",e)}}},o=n,l=(a("a18e"),a("623f")),p=Object(l["a"])(o,r,s,!1,null,"e48cd6a6",null);e["default"]=p.exports},a18e:function(t,e,a){"use strict";var r=a("cae2"),s=a.n(r);s.a},cae2:function(t,e,a){}}]);